<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
.calendar-heading,
.availability-heading {
  text-align: center;
  margin-top: 2%;
}

.arrow-button {
  background: none;
  border: none;
  cursor: pointer;
  font-size: 45px; /* Adjust the font size as needed */
  caret-color: transparent;
}

.arrow-button:hover {
    text-decoration: underline; /* Optional: Add underline on hover */
    color: blue;
}

.calendar-table {
  border-collapse: collapse;
  width: 80%;
  margin: 10%;
  margin-top: 3%;
}

.calendar-td {
  border: 1px solid black;
  text-align: right;
  padding: 5px;
  width: 150px; /* Ensure each day box takes up equal space (100% / 7 days) */
  height: 100px;
  vertical-align: top;
}

.calendar-th {
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  width: 150px; /* Ensure each day box takes up equal space (100% / 7 days) */
  height: 15px;
}
.calendar-th {
  background-color: lightgray;
}
.hours-container {
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    caret-color: transparent;
}
.hours-container:hover {
    cursor: default; /* Change cursor to default */
}
.hour-item {
    display: flex; /* Make it a flex container to align items horizontally */
    align-items: center; /* Align items vertically in the center */
    margin-bottom: 5px; /* Add some margin between each hour item */
}

/* Style for the green button */
.green-button {
    width: 10px; /* Set the width of the button */
    height: 10px; /* Set the height of the button */
    border-radius: 50%; /* Make it round */
    background-color: green; /* Set the background color to green */
    margin-right: 5px; /* Add some margin between the button and the time */
    cursor: pointer;
    caret-color: transparent;
}

</style>
</head>
<body>
  <form id="book-form" action="{{ url_for('customer_routes.start_subdirectory', subdomain=subdomain , subdirectory=subdirectory, month_name=month_name, year=year, day=day, hour=hour) }}">
  <div class="calendar-container">
    <h1 class="calendar-heading">
        <button onclick="updateCalendar('prev', '{{ month_name }}', '{{ year }}')" class="arrow-button">&#8249;</button>
        {{ month_name }} - {{ year }}
        <button onclick="updateCalendar('next', '{{ month_name }}', '{{ year }}')" class="arrow-button">&#8250;</button>            
    </h1>
    <h2 class="availability-heading">
      {{ heading }}
    </h2>    
<table class="calendar-table">
  <thead>
    <tr>
      <th class="calendar-th">Monday</th>
      <th class="calendar-th">Tuesday</th>
      <th class="calendar-th">Wednesday</th>
      <th class="calendar-th">Thursday</th>
      <th class="calendar-th">Friday</th>
      <th class="calendar-th">Saturday</th>
      <th class="calendar-th">Sunday</th>
    </tr>
  </thead>
  <tbody>
    {% for i in range(calendar|length) %}
        <tr>
            {% for j in range(calendar[i]|length) %}
                {% set day = calendar[i][j] %}
                {% set day_hours = processed_calendar[i][j] %}
                <td class="calendar-td">
                  {% if day != 0 %}
                      <div>{{ day }}</div>
                      <div class="hours-container">
                          {% if day_hours %}
                              {% for hour in day_hours %}
                              <div class="hour-item">
                                <div class="green-button"></div>
                                <div>{{ hour }}</div>
                              </div>
                              {% endfor %}
                          {% else %}
                              <div>Not available</div>
                          {% endif %}
                      </div>
                  {% endif %}
              </td>
            {% endfor %}
        </tr>
    {% endfor %}
</tbody>
</table>

</div>
<script>
const subdirectory = '{{ subdirectory }}';

function updateCalendar(direction, month, year) {

// Send a GET request to update the calendar
fetch(`/${subdirectory}?month=${month}&year=${year}&direction=${direction}`)
  .then(response => response.text())
  .then(html => {
    // Replace the content of the calendar container
    document.querySelector('.calendar-container').innerHTML = html;
  })
  .catch(error => console.error('Error updating calendar:', error));
}
</script>
</form>
</body>
</html>
